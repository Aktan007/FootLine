{% extends 'shop/base.html' %}
{% block title %}{% if is_edit %}Редактировать{% else %}Добавить{% endif %} заказ - FootLine{% endblock %}
{% block content %}
<h1 class="fw-bold mb-4">
    <i class="bi bi-clipboard me-2"></i>
    {% if is_edit %}Редактировать заказ{% else %}Добавить новый заказ{% endif %}
</h1>
<div class="row"><div class="col-lg-7">
    <form method="post">
        {% csrf_token %}
        <div class="mb-3">
            <label class="form-label fw-semibold">Номер заказа</label>
            {{ form.order_number }}
            {% if form.order_number.errors %}<div class="text-danger small">{{ form.order_number.errors.0 }}</div>{% endif %}
        </div>
        <div class="mb-3">
            <label class="form-label fw-semibold">Дата заказа</label>
            {{ form.order_date }}
            {% if form.order_date.errors %}<div class="text-danger small">{{ form.order_date.errors.0 }}</div>{% endif %}
        </div>
        <div class="mb-3">
            <label class="form-label fw-semibold">Дата доставки</label>
            {{ form.delivery_date }}
            {% if form.delivery_date.errors %}<div class="text-danger small">{{ form.delivery_date.errors.0 }}</div>{% endif %}
        </div>
        <div class="mb-3">
            <label class="form-label fw-semibold">Пункт выдачи</label>
            {{ form.delivery_point }}
            {% if form.delivery_point.errors %}<div class="text-danger small">{{ form.delivery_point.errors.0 }}</div>{% endif %}
        </div>
        <div class="mb-3">
            <label class="form-label fw-semibold">ФИО клиента</label>
            {{ form.customer_name }}
            {% if form.customer_name.errors %}<div class="text-danger small">{{ form.customer_name.errors.0 }}</div>{% endif %}
        </div>
        <div class="mb-3">
            <label class="form-label fw-semibold">Код для получения</label>
            {{ form.code }}
            {% if form.code.errors %}<div class="text-danger small">{{ form.code.errors.0 }}</div>{% endif %}
        </div>
        <div class="mb-3">
            <label class="form-label fw-semibold">Статус заказа</label>
            {{ form.status }}
            {% if form.status.errors %}<div class="text-danger small">{{ form.status.errors.0 }}</div>{% endif %}
        </div>
        <div class="d-flex gap-2 mt-4">
            <button type="submit" class="btn btn-primary flex-fill">
                <i class="bi bi-check-lg me-1"></i>
                {% if is_edit %}Сохранить изменения{% else %}Добавить заказ{% endif %}
            </button>
            <a href="{% url 'shop:orders_list' %}" class="btn btn-secondary flex-fill text-center">
                <i class="bi bi-x-lg me-1"></i>Отмена
            </a>
        </div>
    </form>
    {% if is_edit and order %}
    <div class="mt-4 p-3 rounded bg-light border">
        <h5 class="fw-bold mb-3"><i class="bi bi-bag me-2"></i>Товары в этом заказе:</h5>
        <ul class="ps-3">
            {% for item in order.items.all %}
            <li><strong>{{ item.product.name }}</strong> ({{ item.product.article }}) &mdash; {{ item.quantity }} шт.</li>
            {% endfor %}
        </ul>
        <p class="mt-2 text-muted small">Для изменения товаров удалите заказ и создайте новый.</p>
    </div>
    {% endif %}
</div></div>
{% endblock %}
